"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[26007],{441224:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=t.SearchBarIcon=t.RichTagTypes=void 0;var r,a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var l=a?Object.getOwnPropertyDescriptor(e,u):null;l&&(l.get||l.set)?Object.defineProperty(r,u,l):r[u]=e[u]}r.default=e;n&&n.set(e,r);return r}(n(667294)),u=m(n(294184)),l=m(n(213192)),o=m(n(314234)),i=m(n(151097)),s=m(n(16941)),d=m(n(259530)),f=m(n(348763)),c=m(n(628551)),p=m(n(582945)),h=n(518802),v=n(770348),g=m(n(247001)),y=m(n(544064));function m(e){return e&&e.__esModule?e:{default:e}}function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap
;return(b=function(e){return e?n:t})(e)}function _(){_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return _.apply(this,arguments)}function T(e,t){T=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return T(e,t)}function E(e,t,n,a){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var u=e&&e.defaultProps,l=arguments.length-3;if(t||0===l||(t={children:void 0}),1===l)t.children=a;else if(l>1){for(var o=new Array(l),i=0;i<l;i++)o[i]=arguments[i+3];t.children=o}if(t&&u)for(var s in u)void 0===t[s]&&(t[s]=u[s]);else t||(t=u||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var S=Object.freeze({SMALL:y.default.small,MEDIUM:y.default.medium,LARGE:y.default.large}),O=(0,l.default)({MEMBER:null,ROLE:null,CHANNEL:null});t.RichTagTypes=O;var I=function(e){
var t,n,r,a=e.hasContent,l=e.onClear,o=e.className,i=e.themeOverride,c=e.size,p=void 0===c?S.SMALL:c;return E(s.default,{className:(0,u.default)(o,y.default.iconLayout,p,(0,h.getThemeClass)(i),(t={},t[y.default.clear]=a,t)),onClick:function(e){e.stopPropagation();null!=l&&l(e)},onMouseDown:function(e){e.preventDefault();e.stopPropagation()},tabIndex:a?0:-1,"aria-hidden":!a,"aria-label":g.default.Messages.SEARCH_CLEAR,focusProps:{offset:4}},void 0,E("div",{className:y.default.iconContainer},void 0,E(f.default,{className:(0,u.default)((n={},n[y.default.icon]=!0,n[y.default.visible]=!a,n))}),E(d.default,{className:(0,u.default)((r={},r[y.default.icon]=!0,r[y.default.visible]=a,r))})))};t.SearchBarIcon=I;I.displayName="SearchBarIcon";var A=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;T(e,t)}(t,e);function t(){for(var t,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];(t=e.call.apply(e,[this].concat(r))||this).defaultInputProps={
role:"combobox","aria-haspopup":"listbox","aria-autocomplete":"list"};t.ref=a.createRef();t.containerRef=a.createRef();t.handleKeyDown=function(e){var n=t.props,r=n.onActivate,a=n.onKeyDown,u=n.onQueryChange,l=n.useKeyboardNavigation;null!=a&&a(e);var o=t.ref.current;if(null!=o&&null==r)if(e.keyCode===v.KeyboardKeys.ESCAPE&&null!=o.value&&""!==o.value&&o.value.length>0){o.value="";null!=u&&u("")}else l&&(t.props.gridResults?t.handleKeyDownGrid(e):t.handleKeyDownList(e));else e.keyCode!==v.KeyboardKeys.TAB&&null!=r&&r(e)};t.handleChange=function(e){var n=t.props.onQueryChange;null!=n&&n(e.currentTarget.value)};t.handleFocus=function(e){var n=t.props.onFocus;null!=n&&n(e)};t.handleClear=function(){var e=t.props.onClear,n=t.ref.current;null!=e&&e();null!=n&&n.focus()};t.handleRemoveTag=function(e){var n=t.props.onRemoveTag;null==n||n(e)};t.focus=function(){var e=t.ref.current;null!=e&&e.focus()};return t}var n=t.prototype;n.componentDidUpdate=function(e){
var t=this.props,n=t.focusAfterReady,r=t.isReady;n&&!e.isReady&&r&&this.focus()};n.handleKeyDownGrid=function(e){var t=this.props,n=t.selectedRow,r=t.selectedColumn,a=t.sections,u=t.query,l=t.tags,o=t.onSelectionChange,i=t.onSelect,s=t.onRemoveTag,d=t.preventEscapePropagation;if(0!==a.length){switch(e.keyCode){case v.KeyboardKeys.BACKSPACE:if((null==u||0===u.length)&&null!=l&&l.length>0){e.preventDefault();e.stopPropagation();null==s||s(l.length-1)}break;case v.KeyboardKeys.ARROW_DOWN:e.preventDefault();e.stopPropagation();if(-1===n){n=0;r=0}else{(n+=1)>=a.length&&(n=a.length-1);r>=a[n]&&(r=a[n]-1)}break;case v.KeyboardKeys.ARROW_UP:e.preventDefault();e.stopPropagation();if((n-=1)<0){n=0;r=0}else r>=a[n]&&(r=a[n]-1);break;case v.KeyboardKeys.ARROW_LEFT:e.preventDefault();e.stopPropagation();-1===n&&(n=0);if((r-=1)<0)if((n-=1)>=0)r=a[n]-1;else if(n<0){n=0;r=0}break;case v.KeyboardKeys.ARROW_RIGHT:e.preventDefault();e.stopPropagation();-1===n&&(n=0);if((r+=1)>=a[n]){r=0
;(n+=1)>=a.length&&(r=a[n=a.length-1]-1)}break;case v.KeyboardKeys.ENTER:e.preventDefault();e.stopPropagation();-1===n&&(n=0);-1===r&&(r=0);if(n>=a.length||r>=a[n])return;null!=i&&i(n,r,e);return;case v.KeyboardKeys.ESCAPE:e.preventDefault();d&&e.stopPropagation();null!=i&&i(null,null,e);return;default:return}null!=o&&o(n,r)}};n.handleKeyDownList=function(e){var t=this.props,n=t.sections,r=t.selectedSection,a=t.selectedRow,u=t.onSelect,l=t.onSelectionChange,o=t.query,i=t.tags,s=t.preventEscapePropagation,d=this.ref.current;if(null!=d)switch(e.keyCode){case v.KeyboardKeys.BACKSPACE:if((null==o||0===o.length)&&null!=i&&i.length>0){var f,c;e.preventDefault();e.stopPropagation();null===(f=(c=this.props).onRemoveTag)||void 0===f||f.call(c,i.length-1)}break;case v.KeyboardKeys.ARROW_DOWN:e.preventDefault();e.stopPropagation();if(n.length>r&&++a>=n[r]){++r>=n.length&&(r=0);a=0}null==l||l(r,a);break;case v.KeyboardKeys.ARROW_UP:e.preventDefault();e.stopPropagation();if(--a<0){
--r<0&&(r=n.length-1);a=n[r]-1}null==l||l(r,a);break;case v.KeyboardKeys.ENTER:e.preventDefault();e.stopPropagation();n.length>r&&n[r]>a&&(null==u||u(r,a,e));break;case v.KeyboardKeys.ESCAPE:e.preventDefault();s&&e.stopPropagation();null==u||u(null,null,e);d.blur()}};n.render=function(){var e,t,n=this,r=this.props,l=r.autoFocus,s=r.query,f=r.placeholder,v=void 0===f?g.default.Messages.DM_SEARCH_PLACEHOLDER:f,m=r.themeOverride,b=r.disabled,T=r.onClear,S=r.size,A=r.maxHeight,C=r.tags,M=r.onActivate,P=r.className,R=r.inputProps,w=r.focusAfterReady,N=null!=s&&s.length>0,D=!1,F=[];if(null!=C&&C.length>0)if("string"==typeof C[0]){C.forEach((function(e,t){return F.push(E(i.default,{focusProps:{offset:4},className:y.default.tag,onClick:n.handleRemoveTag.bind(n,t)},t,e,E(d.default,{className:y.default.close,"aria-label":g.default.Messages.REMOVE})))}))}else{D=!0;C.forEach((function(e,t){return F.push(E(i.default,{className:(0,u.default)(y.default.tag,y.default.richTag),
onClick:n.handleRemoveTag.bind(n,t)},t,e.type===O.MEMBER&&e.avatar&&E(c.default,{src:e.avatar,"aria-label":"",size:c.default.Sizes.SIZE_16}),e.type===O.ROLE&&e.color&&E("span",{className:y.default.tagRoleColor,style:{backgroundColor:e.color}}),E("span",{className:y.default.tagLabel},void 0,e.label),E(d.default,{className:y.default.close,"aria-label":g.default.Messages.REMOVE})))}))}return E(o.default,{focusTarget:this.ref,ringTarget:this.containerRef},void 0,a.createElement("div",{ref:this.containerRef,className:(0,u.default)(P,y.default.container,S,(0,h.getThemeClass)(m),(e={},e[y.default.disabled]=b,e))},E(p.default,{className:y.default.inner,style:{maxHeight:A}},void 0,F,a.createElement("input",_({className:(0,u.default)(y.default.input,(t={},t[y.default.richTagInput]=D,t)),type:"text",ref:this.ref,spellCheck:"false",placeholder:v,value:s,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,disabled:b,"aria-disabled":b,autoFocus:!w&&l,onMouseDown:M
},this.defaultInputProps,R)),null!=T?E(I,{size:S,themeOverride:m,hasContent:N,onClear:this.handleClear}):null)))};return t}(a.Component);A.displayName="SearchBar";A.Sizes=S;A.defaultProps={size:S.SMALL,query:"",sections:[],selectedSection:0,selectedRow:-1,selectedColumn:-1,gridResults:!1,disabled:!1,autoFocus:!1,preventEscapePropagation:!0,useKeyboardNavigation:!0};var C=A;t.default=C},997847:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=t.SortOrder=void 0;var r,a,u=c(n(496486)),l=c(n(795715)),o=c(n(536211)),i=c(n(636602)),s=c(n(191391)),d=c(n(408643)),f=n(770348);function c(e){return e&&e.__esModule?e:{default:e}}function p(e,t){p=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return p(e,t)}t.SortOrder=a;!function(e){e[e.LastMessage=0]="LastMessage";e[e.Creation=1]="Creation"}(a||(t.SortOrder=a={}));var h=null,v=a.LastMessage,g=[],y=[];function m(e,t){h=e;var n=d.default.getThreadIds(e),r=!1;if(n!==g){g=n;r=!0}if(v!==t){v=t;r=!0}if(!r)return!1
;y=(0,u.default)(n).map((function(e){var t,n=e.channelId;return{channelId:n,pinned:e.pinned,lastMessageId:null!==(t=s.default.lastMessageId(n))&&void 0!==t?t:n}})).sort((function(e,t){return e.pinned&&!t.pinned?-1:!e.pinned&&t.pinned?1:v===a.LastMessage?l.default.compare(t.lastMessageId,e.lastMessageId):l.default.compare(t.channelId,e.channelId)})).value()}function b(){return null!=h&&m(h,v)}var _=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;p(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.initialize=function(){this.waitFor(s.default);this.syncWith([d.default],b)};n.getThreadIds=function(e,t){m(e,t);return y};return t}(o.default.Store);_.displayName="ActiveForumPostSortStore";var T=new _(i.default,((r={})[f.ActionTypes.THREAD_DELETE]=b,r));t.default=T},973523:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.GuildForumExperiment=void 0;t.getEnableForumPermissions=function(e){
return w.getCurrentConfig({guildId:e}).enabled};t.useAppliedTags=function(e){var t=D(e);return null==t?[]:e.appliedTags.map((function(e){return null==t?void 0:t[e]})).filter((function(e){return null!=e}))};t.useCanCreateForumChannel=function(e){return N(e)};t.useExistingPin=function(e){var t=(0,l.useStateFromStoresObject)([f.default],(function(){return f.default.getThreadsForGuild(e.guild_id)}),[e.guild_id]);return(0,a.default)(t).values().map((function(e){var t=e.id;return h.default.getChannel(t)})).filter(_.isNotNullish).find((function(t){return t.parent_id===e.parent_id&&t.hasFlag(A.ChannelFlags.PINNED)}))};t.useFacepileUsers=function(e,t){var n=(0,l.useStateFromStoresArray)([b.default],(function(){return t.map((function(e){return b.default.getUser(e)}))}));r.useEffect((function(){t.filter((function(e,t){return null==n[t]})).forEach((function(t){v.default.requestMember(e.guild_id,t)}))}),[]);return n};t.useFirstAppliedTag=function(e){var t=D(e);return r.useMemo((function(){
var n=e.appliedTags.find((function(e){return null!=(null==t?void 0:t[e])}));return null!=n?null==t?void 0:t[n]:void 0}),[t,e.appliedTags])};t.useFormumPostMarkup=function(e){var t=r.useMemo((function(){return null!=(null==e?void 0:e.content)&&""!==e.content?(0,s.default)(e,{formatInline:!0,allowHeading:!0,allowList:!0}):{hasSpoilerEmbeds:!1,content:null}}),[e]),n=t.hasSpoilerEmbeds,a=t.content,u=(0,S.useFindFirstMediaProperties)(e,n);return{hasSpoilerEmbeds:n,content:a,firstMedia:u}};t.useForumPostCreator=function(e){var t=(0,l.useStateFromStores)([b.default],(function(){return b.default.getUser(e.ownerId)})),n=(0,d.useNullableUserAuthor)(t,e);r.useEffect((function(){null!=e.ownerId&&v.default.requestMember(e.guild_id,e.ownerId)}),[e.guild_id,e.ownerId]);return{user:t,author:n}};t.useIsForumExperimentEnabled=N;t.useLastActiveTimestamp=function(e,t){var n=u.default.extractTimestamp((0,l.useStateFromStores)([g.default],(function(){return g.default.lastMessageId(e.id)
}))),r=u.default.extractTimestamp(e.id);return t===T.SortOrder.Creation?(0,p.getForumCreatedAgoTimestampString)(r):(0,p.getForumActiveAgoTimestampString)(n)};t.useLoadForumUnreadCounts=function(e){var t=(0,l.useStateFromStores)([f.default],(function(){return f.default.hasLoaded(e.guild_id)}));r.useEffect((function(){if(t){var n=E.default.getThreadIds(e.id),r=O.default.getThreadIdsMissingCounts(e.guild_id,n.map((function(e){return e.channelId}))).filter((function(e){return null!=g.default.getTrackedAckMessageId(e)})).map((function(e){return{threadId:e,ackMessageId:g.default.getTrackedAckMessageId(e)}}));r.length>0&&o.default.dirtyDispatch({type:I.ActionTypes.REQUEST_FORUM_UNREADS,guildId:e.guild_id,channelId:e.id,threads:r})}}),[e.id,e.guild_id,t])};t.useMessageCount=function(e){var t=(0,l.useStateFromStores)([c.default],(function(){var t;return null!==(t=c.default.getCount(e.id))&&void 0!==t?t:0})),n=t>=C.MAX_THREAD_MESSAGE_COUNT?"50+":t,r=(0,
l.useStateFromStores)([g.default],(function(){return g.default.hasTrackedUnread(e.id)})),a=(0,l.useStateFromStores)([g.default],(function(){return g.default.hasEverViewed(e.id)})),u=(0,l.useStateFromStores)([O.default],(function(){return O.default.getCount(e.id)}));return{renderedMessageCount:n,displayedUnreadCount:a&&r&&null!=u&&u>0?u>=10?"10+":u:null}};t.useMostUsedReaction=function(e){var t,n,r,u=a.default.sortBy(null!==(t=null==e?void 0:e.reactions)&&void 0!==t?t:[],"count").reverse()[0],l=null!==(n=null==u?void 0:u.emoji)&&void 0!==n?n:F,o=null!==(r=null==u?void 0:u.count)&&void 0!==r?r:0;return{emoji:l,count:o}};t.useTypingUserIds=function(e){return(0,l.useStateFromStoresArray)([m.default,b.default,y.default],(function(){var t=b.default.getCurrentUser();return(0,a.default)(m.default.getTypingUsers(e.id)).keys().filter((function(e){return e!==(null==t?void 0:t.id)})).reject(y.default.isBlocked).map((function(e){return b.default.getUser(e)
})).filter(_.isNotNullish).map((function(e){return e.id})).value()}))};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=P(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var l=a?Object.getOwnPropertyDescriptor(e,u):null;l&&(l.get||l.set)?Object.defineProperty(r,u,l):r[u]=e[u]}r.default=e;n&&n.set(e,r);return r}(n(667294)),a=M(n(496486)),u=M(n(795715)),l=n(536211),o=M(n(636602)),i=M(n(822350)),s=M(n(116518)),d=n(907932),f=M(n(782270)),c=M(n(979674)),p=n(566142),h=M(n(644263)),v=M(n(737483)),g=M(n(191391)),y=M(n(290629)),m=M(n(946447)),b=M(n(728429)),_=n(71246),T=n(997847),E=M(n(408643)),S=n(140092),O=M(n(962935)),I=n(770348),A=n(173652),C=n(64072);function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if("function"!=typeof WeakMap)return null
;var t=new WeakMap,n=new WeakMap;return(P=function(e){return e?n:t})(e)}function R(){R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return R.apply(this,arguments)}var w=(0,i.default)({id:"2021-07_threads_only_channel",label:"Threads only channel",kind:"guild",defaultConfig:{enabled:!1},treatments:[{id:1,label:"On",config:{enabled:!0}}]});t.GuildForumExperiment=w;function N(e){return w.useExperiment({guildId:e}).enabled}function D(e){var t=(0,l.useStateFromStores)([h.default],(function(){return h.default.getChannel(e.parent_id)}),[e.parent_id]);return r.useMemo((function(){var e;return null==t||null===(e=t.availableTags)||void 0===e?void 0:e.reduce((function(e,t){var n;return R({},e,((n={})[t.id]=t,n))}),{})}),[null==t?void 0:t.availableTags])}var F={id:null,name:"👍"}},140092:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0})
;t.useFindFirstMediaProperties=function(e,t){var n,l=r.InlineAttachmentMedia.useSetting(),o=r.InlineEmbedMedia.useSetting(),i=r.RenderEmbeds.useSetting();if(null==e)return null;var s=l?null===(n=e.attachments)||void 0===n?void 0:n.find((function(e){return function(e){if(null==e)return!1;var t=e.filename,n=e.height,r=e.width;return a.IMAGE_RE.test(t)&&null!=n&&n>0&&null!=r&&r>0}(e)||function(e){return null!=e&&(null!=e&&a.VIDEO_RE.test(e.filename)&&null!=e.proxy_url)}(e)})):null;if(null!=s){var d=s.proxy_url,f=s.url,c=s.description,p=s.spoiler,h=s.width,v=s.height,g=s.filename;return null==h||null==v?null:{src:a.VIDEO_RE.test(g)?d+"?format=jpeg":null!=d?d:f,width:h,height:v,spoiler:null!=p&&p,alt:c}}if(!o||!i)return null;if(null==e.embeds)return null;for(var y,m=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t)
;var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.embeds);!(y=m()).done;){var b,_=y.value,T=null!==(b=_.image)&&void 0!==b?b:_.thumbnail;null==T&&null!=_.images&&(T=_.images[0]);if(null!=T&&null!=T.url){var E=T,S=E.height,O=E.proxyURL,I=E.url,A=E.width;return{src:null!=O&&""!==O?O:I,height:S,width:A,spoiler:t}}}return null};var r=n(894826),a=n(100678);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},962935:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0})
;t.default=void 0;var r,a=f(n(441143)),u=f(n(536211)),l=f(n(636602)),o=f(n(782270)),i=f(n(644263)),s=f(n(191391)),d=n(770348);function f(e){return e&&e.__esModule?e:{default:e}}function c(e,t){c=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return c(e,t)}var p={},h=new Set;var v=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;c(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.initialize=function(){this.waitFor(o.default,i.default,s.default)};n.getCount=function(e){return p[e]};n.getThreadIdsMissingCounts=function(e,t){(0,a.default)(o.default.hasLoaded(e),"must wait for THREAD_LIST_SYNC before calling this");return t.filter((function(e){return!(e in p)&&!h.has(e)}))};return t}(u.default.Store);v.displayName="ForumPostUnreadCountStore";var g=new v(l.default,((r={})[d.ActionTypes.CONNECTION_OPEN]=function(){p={};h=new Set},r[d.ActionTypes.THREAD_CREATE]=function(e){var t=e.channel
;if(!e.isNewlyCreated)return!1;if(!o.default.hasLoaded(t.guild_id))return!1;p[t.id]=0},r[d.ActionTypes.MESSAGE_CREATE]=function(e){var t=e.channelId,n=e.optimistic,r=e.isPushNotification;if(n||r)return!1;if(!(t in p))return!1;p[t]++},r[d.ActionTypes.FORUM_UNREADS]=function(e){e.threads.forEach((function(e){null!=e.count&&(p[e.threadId]=e.count)}))},r[d.ActionTypes.MESSAGE_ACK]=function(e){var t=e.channelId;if(!(t in p)){var n=i.default.getChannel(t),r=i.default.getChannel(null==n?void 0:n.parent_id);if(!(null==r?void 0:r.isForumChannel()))return!1}p[t]=s.default.getUnreadCount(t)},r[d.ActionTypes.REQUEST_FORUM_UNREADS]=function(e){e.threads.forEach((function(e){var t=e.threadId;return h.add(t)}))},r));t.default=g},946447:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=void 0;var r,a=d(n(536211)),u=d(n(118915)),l=d(n(636602)),o=d(n(423046)),i=n(249875),s=n(770348);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){
f=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return f(e,t)}function c(){c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return c.apply(this,arguments)}var p,h={},v=Object.freeze({});function g(e){var t;return null!==(t=h[e])&&void 0!==t?t:v}function y(e){var t=e.channelId,n=e.userId,r=c({},g(t));clearTimeout(r[n]);r[n]=function(e,t){return setTimeout((function(){l.default.dispatch({type:s.ActionTypes.TYPING_STOP,channelId:e,userId:t})}),s.TYPING_TIMEOUT)}(t,n);h[t]=r}function m(e){var t=e.channelId,n=e.userId,r=h[t];if(null==r||null==r[n])return!1;var a=c({},r);clearTimeout(a[n]);delete a[n];h[t]=a}function b(){h={}}var _=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;f(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.getTypingUsers=function(e){return g(e)}
;n.isTyping=function(e,t){return null!=g(e)[t]};return t}(a.default.Store);_.displayName="TypingStore";var T=new _(l.default,((r={})[s.ActionTypes.TYPING_START]=y,r[s.ActionTypes.TYPING_STOP]=m,r[s.ActionTypes.TYPING_START_LOCAL]=function(e){var t=e.channelId,n=o.default.getId();if(null==n)return!1;if(null!=p&&p.channelId!==t){null!=p.timeout&&clearTimeout(p.timeout);p=null}var r=Date.now(),a=.8*s.TYPING_TIMEOUT;if(null!=p&&(null!=p.timeout||p.prevSend+a>r))return!1;var d=null==p||p.prevSend>r-2*a?s.TYPING_DELAY_LOCAL:0,f=setTimeout((function(){if(null!=p&&p.channelId===t&&n===o.default.getId()&&null!=p.timeout){p.timeout=null;(function(e){var t=g(e);return t===v?0:Object.keys(t).length})(t)>s.MAX_TYPING_USERS||u.default.post({url:s.Endpoints.TYPING(t),oldFormErrors:!0}).then((function(e){if(200===e.status){var n,r,a=null!==(n=e.body.message_send_cooldown_ms)&&void 0!==n?n:0,u=null!==(r=e.body.thread_create_cooldown_ms)&&void 0!==r?r:0;a>0&&l.default.dispatch({
type:s.ActionTypes.SLOWMODE_SET_COOLDOWN,channelId:t,slowmodeType:i.SlowmodeType.SendMessage,cooldownMs:a});u>0&&l.default.dispatch({type:s.ActionTypes.SLOWMODE_SET_COOLDOWN,channelId:t,slowmodeType:i.SlowmodeType.CreateThread,cooldownMs:u})}}))}}),d);p={channelId:t,timeout:f,prevSend:r};return y({channelId:t,userId:n})},r[s.ActionTypes.TYPING_STOP_LOCAL]=function(e){var t=e.channelId,n=o.default.getId();if(null==n)return!1;if(null!=p&&p.channelId===t&&null!=p.timeout){clearTimeout(p.timeout);p=null;return m({channelId:t,userId:n})}return!1},r[s.ActionTypes.CONNECTION_OPEN]=b,r[s.ActionTypes.OVERLAY_INITIALIZE]=b,r[s.ActionTypes.MESSAGE_CREATE]=function(e){var t=e.channelId,n=e.message.author;e.optimistic&&function(e){if(null==p||p.channelId!==e)return!1;null!=p.timeout&&clearTimeout(p.timeout);p=null}(t);return m({channelId:t,userId:n.id})},r));t.default=T}}]);
//# sourceMappingURL=4db44807d95f283b76dc.js.map